---
title: "Journal"
output:
  html_document:
    toc: true
    toc_float: true
    collapsed: false
    number_sections: false
    toc_depth: 1
    #code_folding: hide
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(message=FALSE,warning=FALSE, cache=TRUE)
```



Here, I'll be adding graphs and other visuals made in R on a variety of topics.  I'm working on improving my R skills and really enjoy trying out new packages and visualization tools, so these graphs are in no way meant to be professional quality and are simply a way for me to post my progress in this small portfolio.  Enjoy!  


```{r include=FALSE}
library(dplyr)
library(magrittr) 
library(psych)
library(foreign)
library(car)
library(data.table)
library(knitr)
library(ggplot2)
library(broom) 
library(tidyr)
library(plotly)
library(broom)
library(readxl)
library(tibble)
library(janitor)
library(plotly)
library(hrbrthemes)
library(mFilter)
library(xts)
library(dygraphs)
library(scales)
library(htmlwidgets)
library(gapminder)
library(gganimate)
library(babynames)
library(hrbrthemes)
library(viridis)
library(gifski)
library(gapminder)
library(png)
library(prettydoc)
library(cowplot)
library(googleway)
library(ggrepel)
library(ggspatial)
library(sf)
library(rnaturalearth)
library(rnaturalearthdata)
library(usmap)


#install.packages("prettydoc")

```



# Electricity Generation by Source
2020 | 12 | 23

This plot shows US electricity generation since 1984 broken down by generation source using data from the US Energy Information Administration.  As you can see, coal was the primary source leading into the 21st century, but just before 2010, dropped off sharply and was overtaken by natural gas.  Around the same time, petroleum also began to fall.  On the other hand, renewables have been climbing steadily since the early 90s and the rate of increase took off in the mid 2000s.  Nuclear power saw an earlier increase, rising most before 2000, and leveling off from that point forward.  Going into the 2020s, it's expected that coal power will continue to drop off and renewables will make up the lost generation.  Nuclear power has huge potential to assist in replacing fossil fuels and as an excellent clean energy source, could be vital in reaching emission reduction goals in the future. 

```{r include=FALSE}
data_dirl <-"~/Documents/Dynamic Economics/EViews Graphs/R" 
data2 <- read_excel(file.path(data_dirl,
                                    "gen.xlsx"))

names(data2) <- data2[5,]
data2 <- data2[-c(1:5),]
data2$year <- as.numeric(data2$year)
data2$gen <- as.numeric(data2$gen)
data2$percent <- as.numeric(data2$percent)

data2 %>%
  ggplot( aes(x=year, y=gen, group=type, color=type)) +
    geom_line()

# Plot
plotdd <- data2 %>%
  ggplot( aes(x=year, y=gen, group=type, color=type)) +
    geom_line() +
    geom_point() +
    scale_color_viridis(discrete = TRUE) +
    labs(title="U.S. electricity generation by major energy source",
              subtitle="Billion kWh from utility-scale facilities")+
    theme_ipsum() +
    ylab("Billion kWh") +
    xlab("Year")+
    scale_color_manual(name="Source",
                       labels=c("Coal","Natural Gas","Nuclear", "Petroleum + other", "Renewables"),
                       values=c("red","orange","yellow", "green", "blue"))+
    transition_reveal(year)

```


```{r echo=FALSE}
plotdd
```




# White Christmas
2020 | 12 | 22

It's that time of year!  In this graph, I used 2016 data from the National Oceanic and Atmospheric Administration which estimated the probability of a white Christmas based on data collected over the past 3 decades.  I used several new packages for this, including "usmap", "rnaturalearthdata", and "sf". Unfortunately, I was lacking data from the west half of the US, so the data points were not as dense as I had hoped.  I also think in the future, it would be interesting to try to find a way to map this over time, so the change in probability from year to year can be observed through animation or a year slider.  Anyway, the results here are no surprise, with northern areas much more likely to experience snow.  Of course, whether or not it snows in your region will depend highly on local weather patterns on or before the 25th, which can be found at Weather.gov. Happy holidays!     

```{r include=FALSE}
data_dir <-"~/Documents/Dynamic Economics/EViews Graphs/R" 


data <- read_excel(file.path(data_dir,
                               "snow.xlsx"))
`%notin%` <- Negate(`%in%`)

data <- data %>% drop_na() %>% 
 filter(state %notin% c("AS","FM", "MP", "PR", "PW", "UM", "GU", "MH", "VI"))

duplicated(data[,1:2])


transform <- usmap_transform(data)
glimpse(transform)

unique(data$State)

map <- plot_usmap() +
  geom_point(data = transform, aes(x = lon.1, y = lat.1, col = prob), size=2.2, alpha=.8) +
  labs(title = "Probabilty of a White Christmas by Location",
       subtitle = "Source: National Oceanic and Atmospheric Administration, 2016",
       col = "Probability") +
  theme(plot.title = element_text(size = 14, face = "bold"), legend.position = "right")

```
```{r echo=FALSE}
map
```



# TED Spread
2020 | 12 | 20

This graph is a simple plot of the TED Spread from 1986 until present day, using data from FRED.  The TED spread is the difference between the three-month Treasury bill and the three-month LIBOR based in US dollars, or in other words, the difference between the interest rate on short-term US government debt and the interest rate on interbank loans.  It can be used as an indicator of the solvency of financial institutions, monetary liquidity, and percieved risk of the financial system and as a result, is considered important to investment analysis.  To make this graph, I used the package "dygraphs" which displays data point values on the graph when hovered over and allows the viewer to adjust the x axis as desired. 




```{r include=FALSE}

data_dirxx <-"~/Documents/Dynamic Economics/EViews Graphs/Part I" 
data11 <- read_excel(file.path(data_dirxx,
                               "TED.xls"))

names(data11) <- data11[10,]
data11 <- data11[-c(1:10),-c(3:5)]

data11$observation_date <-  excel_numeric_to_date(as.numeric(as.character(data11$observation_date)), date_system = "modern")
data11$spread <- as.numeric(data11$spread)

dona <- xts(x = data11$spread, order.by = data11$observation_date)

p <- dygraph(dona,
             main = "TED Spread",
             ylab = "Spread(%)",
             xlab = "Date") %>%
  dyOptions(labelsUTC = TRUE, fillGraph=TRUE, fillAlpha=0.1, drawGrid = FALSE, colors="#D8AE5A") %>%
  dyRangeSelector() %>%
  dyCrosshair(direction = "vertical") %>%
  dyHighlight(highlightCircleSize = 5, highlightSeriesBackgroundAlpha = 0.2, hideOnMouseOut = FALSE)  %>%
  dyRoller(rollPeriod = 1) %>%
  dyShading(from="1990-07-01", to="1991-03-01", axis = "x") %>% 
  dyShading(from="2001-03-01	", to="2001-11-01", axis = "x") %>% 
  dyShading(from="2007-12-01", to="2009-06-01", axis = "x") %>% 
  dyShading(from="2020-02-01", to="2020-12-01	", axis = "x")

```

```{r echo=FALSE}
p
```



# Baby Names
2020 | 12 | 20

A fun plot made using data from the R package "babynames".  I selected my name, as well as my sister and mothers names to plot from 1880 until present day.  Frances was most popular around 1920, while Grace peaked in popularity around 2000, a few years after I was born.  Kimberly experienced the most dramatic spike in popularity in the late 1960's, which was around the time my mother was born.  Looking at this data, it appears that my mother had the trendiest name, while I was named slightly ahead of the trend.  Interestingly, Frances and Grace seem to follow a similar trend from 1880 - 1980.

```{r include=FALSE}
don <- babynames %>% 
  filter(name %in% c("Grace", "Frances", "Kimberly")) %>%
  filter(sex=="F")
  
# Plot
plotd <- don %>%
  ggplot( aes(x=year, y=n, group=name, color=name)) +
    geom_line() +
    geom_point() +
    scale_color_viridis(discrete = TRUE) +
    ggtitle("Popularity of American names since 1880") +
    theme_ipsum() +
    ylab("Number of babies born") +
    transition_reveal(year)
```

```{r echo=FALSE}
plotd
```







